@page
@model WholeProjectViewModel
@{
    Layout = "_Layout";
    ViewData["Title"] = "Whole Project View";

    var currentDate = DateTime.Today;
    int month = Model.SelectedMonth;
    int year = Model.SelectedYear;
    DateTime firstDayOfMonth = new DateTime(year, month, 1);
    int daysInMonth = DateTime.DaysInMonth(year, month);
    var daysOfMonth = Enumerable.Range(1, daysInMonth).Select(day => new DateTime(year, month, day)).ToArray();
}

<h2>Whole Project View</h2>

<div class="month-navigation">
    <form method="get">
        <input type="hidden" name="year" value="@year" />
        <input type="hidden" name="month" value="@month" />
        <button name="change" value="prev">&lt; Previous Month</button>
        <h3>@firstDayOfMonth.ToString("MMMM yyyy")</h3>
        <button name="change" value="next">Next Month &gt;</button>
    </form>
</div>

<div class="calendar-container">
    @foreach (var day in daysOfMonth)
    {
        var entriesForDay = Model.TimeSlots.Where(ts => ts.TSDate.Date == day.Date).ToList();

        <div class="day @(day == DateTime.Today ? "current-day" : "")">
            <div class="date">@day.ToString("dddd, MMM dd")</div>
            <div class="time-entries">
                @if (entriesForDay.Any())
                {
                    @foreach (var entry in entriesForDay)
                    {
                        <div>@entry.TSDuration minutes - @entry.TSDescription</div>
                    }
                }
                else
                {
                    <p>No time entries.</p>
                }
            </div>
        </div>
    }
</div>
