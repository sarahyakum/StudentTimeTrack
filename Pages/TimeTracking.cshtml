@page
@model TimeTrackingPageModel
@{
    Layout = "_Layout";
    ViewData["Title"] = "Time Tracking Page";

    // Set the current date
    var currentDate = DateTime.Today;
}

<h2>Time Tracking</h2>

<div class="time-tracking-container">
    <h3>Current Date: @currentDate.ToString("dddd, MMMM dd yyyy")</h3>

    <div class="inputs-container">
        <form method="post">
            <div class="form-group">
                <label for="time">Time (HH:MM):</label>
                <input type="text" id="time" name="time" placeholder="HH:MM" required pattern="^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$" title="Please enter a valid time in HH:MM format." />
            </div>

            <div class="form-group">
                <label for="description">Description:</label>
                <textarea id="description" name="description" rows="3" required></textarea>
            </div>

            <div class="form-group">
                <label for="dateSelection">Date:</label>
                <input type="date" id="dateSelection" name="dateSelection" value="@currentDate.ToString("yyyy-MM-dd")" required />
            </div>

            <div class="form-group">
                <button type="submit" class="btn">Submit</button>
            </div>
        </form>
    </div>

    <div class="button-container">
        <a href="/WeeklyView" class="btn">Weekly View</a>
        <button class="btn" onclick="openEditPopup()">Edit</button>
    </div>

    <div class="message">
        @if (Model.SuccessMessage != null)
        {
            <p class="success">@Model.SuccessMessage</p>
        }
        else if (Model.ErrorMessage != null)
        {
            <p class="error">@Model.ErrorMessage</p>
        }
    </div>
</div>

<!-- Edit Popup -->
<div id="editPopup" class="popup" style="display:none;">
    <div class="popup-content">
        <span class="close" onclick="closeEditPopup()">&times;</span>
        <h3>Edit Time Entry</h3>
        <form method="post">
            <div class="form-group">
                <label for="editTime">Time (HH:MM):</label>
                <input type="text" id="editTime" name="editTime" placeholder="HH:MM" required pattern="^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$" title="Please enter a valid time in HH:MM format." />
            </div>

            <div class="form-group">
                <label for="editDescription">Description:</label>
                <textarea id="editDescription" name="editDescription" rows="3" required></textarea>
            </div>

            <div class="form-group">
                <button type="submit" class="btn">Save Changes</button>
            </div>
        </form>
    </div>
</div>

<!-- JavaScript for Popup -->
<script>
    function openEditPopup() {
        document.getElementById("editPopup").style.display = "block";
    }

    function closeEditPopup() {
        document.getElementById("editPopup").style.display = "none";
    }
</script>
